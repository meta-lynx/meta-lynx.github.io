"use strict";(self.webpackChunkmetascatter=self.webpackChunkmetascatter||[]).push([[892],{3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return h}});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(a),h=o,m=p["".concat(s,".").concat(h)]||p[h]||u[h]||r;return a?n.createElement(m,i(i({ref:t},d),{},{components:a})):n.createElement(m,i({ref:t},d))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},9054:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return s},default:function(){return h},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var n=a(7462),o=a(3366),r=(a(7294),a(3905)),i=["components"],l={sidebar_position:4},s="Improving your model with unlabelled data",c={unversionedId:"using-metascatter/improving-your-model",id:"using-metascatter/improving-your-model",title:"Improving your model with unlabelled data",description:"Metascatter allows you to explore data as you choose, and how to best improve your model depends on the key requirements of your business. However, we will cover some standard methods to address errors in an intelligent way when you have unlabelled data available.",source:"@site/docs/using-metascatter/improving-your-model.md",sourceDirName:"using-metascatter",slug:"/using-metascatter/improving-your-model",permalink:"/metascatterV2/docs/using-metascatter/improving-your-model",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Basic usage: Image basket",permalink:"/metascatterV2/docs/using-metascatter/basic-usage-basket"}},d={},u=[{value:"High confidence errors",id:"high-confidence-errors",level:2},{value:"Low confidence predictions on unlabelled data",id:"low-confidence-predictions-on-unlabelled-data",level:2},{value:"Outliers of a particular class",id:"outliers-of-a-particular-class",level:2},{value:"Confusion between overlapping classes",id:"confusion-between-overlapping-classes",level:2},{value:"Dataset References",id:"dataset-references",level:3}],p={toc:u};function h(e){var t=e.components,l=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,n.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"improving-your-model-with-unlabelled-data"},"Improving your model with unlabelled data"),(0,r.kt)("p",null,"Metascatter allows you to explore data as you choose, and how to best improve your model depends on the key requirements of your business. However, we will cover some standard methods to address errors in an intelligent way when you have unlabelled data available."),(0,r.kt)("p",null,"You can run unlabelled data through your trained model in the standard inference mode and also through your feature extractor model to produce the co-ordinates for the scatter plot (see ",(0,r.kt)("a",{parentName:"p",href:"/metascatterV2/docs/getting-started/data-preparation-v2"},"Data Preparation"),"). Often we can only label a small fraction of the unlabelled data we have and we need to prioritise which data we choose."),(0,r.kt)("p",null,"We will cover the scenarios below, concretised using the dog breed classification example:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#high-confidence-errors"},"High confidence errors")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#low-confidence-predictions-on-unlabelled-data"},"Low confidence predictions on unlabelled data")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#outliers-of-a-particular-class"},"Outliers of a particular class")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#confusion-between-overlapping-classes"},"Confusion between overlapping classes"))),(0,r.kt)("p",null,"A useful tool is the ",(0,r.kt)("strong",{parentName:"p"},"k-Nearest Neighbour selector")," which allows you to automatically find a chosen number of the most similar images (typically in the unlabelled dataset) to a given selection. We will create a new ",(0,r.kt)("strong",{parentName:"p"},"Basket")," for each task. "),(0,r.kt)("h2",{id:"high-confidence-errors"},"High confidence errors"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Problem"),": ",(0,r.kt)("strong",{parentName:"p"},"We have data that is predicted incorrectly in our test set, but with high confidence")),(0,r.kt)("p",null,"We can filter these points as above but selecting test set data, errors, and high confidence of prediction. We can then find which of the unlabelled data points are closest to the points of contention to be sent for labelling and retraining, using the ",(0,r.kt)("inlineCode",{parentName:"p"},"KNN Selector"),"."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the Selector tab in the Scatter plot"),(0,r.kt)("li",{parentName:"ol"},"Select Field Type = TEST -> Create New Selection with Rule"),(0,r.kt)("li",{parentName:"ol"},"AND Field Error = Incorrect -> Apply Rule to Current Selection"),(0,r.kt)("li",{parentName:"ol"},"AND Field Confidence > 80.0 -> Apply Rule to Current Selection")),(0,r.kt)("p",null,"Now that the images which have been erroneously predicted with high confidence have been isolated, we want to correct for those using similar images that have not yet been used for training. To do this, we find the most similar images in the UNLABELLED data using the KNN selector. "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Select the number of similar images you want to inlcude (e.g. 100)"),(0,r.kt)("li",{parentName:"ol"},"Select points from UNLABELLED"),(0,r.kt)("li",{parentName:"ol"},"Autoselect these points - the most similar images will automatically be selected"),(0,r.kt)("li",{parentName:"ol"},"Open the Basket tab"),(0,r.kt)("li",{parentName:"ol"},"Create a new basket and name it "),(0,r.kt)("li",{parentName:"ol"},"Add the N points to the basket")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Finding the nearest neighbours of selected points",src:a(9119).Z,width:"1450",height:"960"})),(0,r.kt)("p",null,"These images and their metadata can then be exported out of the tool for labelling."),(0,r.kt)("h2",{id:"low-confidence-predictions-on-unlabelled-data"},"Low confidence predictions on unlabelled data"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Problem"),": ",(0,r.kt)("strong",{parentName:"p"},"When unlabelled data are run through the model they are classified with low confidence, indicating lack of surity of the model")),(0,r.kt)("p",null,"It is likely that the model has not be trained on images that look like these. These points can be filtered and added directly to the basket to be sent for labelling."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the Selector Tab in the Scatter Plot"),(0,r.kt)("li",{parentName:"ol"},"Select Field Type = UNLABELLED -> Create New Selection with Rule"),(0,r.kt)("li",{parentName:"ol"},"AND Field Confidence < 20 -> Apply Rule to Current Selection"),(0,r.kt)("li",{parentName:"ol"},"Open the Basket Tab"),(0,r.kt)("li",{parentName:"ol"},"Create New Basket and name it something sensible"),(0,r.kt)("li",{parentName:"ol"},"Add the points to the Basket")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Finding the nearest neighbours of selected points",src:a(975).Z,width:"1450",height:"960"})),(0,r.kt)("h2",{id:"outliers-of-a-particular-class"},"Outliers of a particular class"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Problem"),": ",(0,r.kt)("strong",{parentName:"p"},"There are some images which fall far from the other images in their class")),(0,r.kt)("p",null,"For instance, we want to examine the outliers of the class Norwegian Elkhound. "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the Selector tab of the Scatter plot"),(0,r.kt)("li",{parentName:"ol"},"Select Field Labels = Norwegian Elkhound -> Create New Selection with Rule"),(0,r.kt)("li",{parentName:"ol"},"Use the ",(0,r.kt)("em",{parentName:"li"},"Intersection")," Selection Tool from the top horizontal menu to draw around only the outliers from the class"),(0,r.kt)("li",{parentName:"ol"},"Open the Basket tab"),(0,r.kt)("li",{parentName:"ol"},"Create a New Basket"),(0,r.kt)("li",{parentName:"ol"},"Add the selected points to the Basket")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Finding the nearest neighbours of selected points",src:a(8970).Z,width:"1450",height:"960"})),(0,r.kt)("p",null,"Selecting these outliers and adding them to a new basket allows for further exploration. Perhaps the classifier does not work well on images with poor lighting? Or perhaps the presence of other objects in the images is a source of confusion?"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Finding the nearest neighbours of selected points",src:a(3898).Z,width:"1539",height:"959"})),(0,r.kt)("h2",{id:"confusion-between-overlapping-classes"},"Confusion between overlapping classes"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Problem"),": ",(0,r.kt)("strong",{parentName:"p"},"Two classes often get confused with each other")),(0,r.kt)("p",null,"Overlapping clusters indicates that two classes are getting frequently confused for each other. More training data in this decision boundary might help the classifier. We can add nearest neighbours to the area of confusion from the unlablled dataset."),(0,r.kt)("p",null,"You can scan the scatter plot to get an overview of where confusion occurs. Taking the example of the Clumber and   dog breed classes which overlap. "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the Selector tab of the Scatter plot"),(0,r.kt)("li",{parentName:"ol"},"Select Field Labels = Weimaraner -> Creat New Selection with Rule"),(0,r.kt)("li",{parentName:"ol"},"OR Select Field Labels = Clumber -> Apply Rule to Current Selection"),(0,r.kt)("li",{parentName:"ol"},"Use the ",(0,r.kt)("em",{parentName:"li"},"Intersection")," Selection Tool from the top horizontal menu to draw around the decision boundary"),(0,r.kt)("li",{parentName:"ol"},"From the KNN selector, enter the number of similar images you want (e.g. 20)"),(0,r.kt)("li",{parentName:"ol"},"Select points from UNLABELLED"),(0,r.kt)("li",{parentName:"ol"},"Autoselect points"),(0,r.kt)("li",{parentName:"ol"},"Open the Basket tab"),(0,r.kt)("li",{parentName:"ol"},"Create a New Basket with a sensible name"),(0,r.kt)("li",{parentName:"ol"},"Add the selected points to the Basket")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Finding the nearest neighbours of selected points",src:a(9229).Z,width:"1545",height:"960"})),(0,r.kt)("h3",{id:"dataset-references"},"Dataset References"),(0,r.kt)("p",null,"[1]"," Aditya Khosla, Nityananda Jayadevaprakash, Bangpeng Yao and Li Fei-Fei. Novel dataset for Fine-Grained Image Categorization. First Workshop on Fine-Grained Visual Categorization (FGVC), IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2011. "),(0,r.kt)("p",null,"[2]"," J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li and L. Fei-Fei, ImageNet: A Large-Scale Hierarchical Image Database. IEEE Computer Vision and Pattern Recognition (CVPR), 2009."))}h.isMDXComponent=!0},9229:function(e,t,a){t.Z=a.p+"assets/images/decision_boundary-bad02dc676641edadb57884d5f3fd1f5.gif"},3898:function(e,t,a){t.Z=a.p+"assets/images/elkhound_outliers-74c21b26f32e865dce0c7e266ee00aac.png"},9119:function(e,t,a){t.Z=a.p+"assets/images/high_confidence_errors-1937155e72cefe5ffc234699fc22135a.gif"},8970:function(e,t,a){t.Z=a.p+"assets/images/norwegian_elkhound_outliers-d69d8eea057afaaf406370371a87cdba.gif"},975:function(e,t,a){t.Z=a.p+"assets/images/unlabelled_low_confidence-1826d866c0517b88ee71b9748aa11e72.gif"}}]);